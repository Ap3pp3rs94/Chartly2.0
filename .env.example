# Chartly 2.0  Environment Template
# Copy to .env for local development. Do NOT commit .env.

############################
# Global
############################
CHARTLY_ENV=local
CHARTLY_LOG_LEVEL=info

# Optional tenant default for local testing
CHARTLY_DEFAULT_TENANT_ID=local

############################
# Ports (local defaults)
############################
GATEWAY_PORT=8080
ORCHESTRATOR_PORT=8081
CONNECTOR_HUB_PORT=8082
NORMALIZER_PORT=8083
ANALYTICS_PORT=8084
STORAGE_PORT=8085
AUDIT_PORT=8086
AUTH_PORT=8087
OBSERVER_PORT=8088

############################
# Postgres (metadata / relational)
############################
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_DB=chartly
POSTGRES_USER=chartly
POSTGRES_PASSWORD=chartly

# Standard DSNs (services may read either)
POSTGRES_DSN=postgres://chartly:chartly@localhost:5432/chartly?sslmode=disable

############################
# Redis (cache / queues / rate limits)
############################
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_URL=redis://localhost:6379/0

############################
# Blob storage (raw payloads / artifacts)
# Use MinIO locally; S3 in prod.
############################
BLOB_PROVIDER=minio
BLOB_S3_ENDPOINT=http://localhost:9000
BLOB_S3_REGION=us-east-1
BLOB_S3_ACCESS_KEY=minioadmin
BLOB_S3_SECRET_KEY=minioadmin
BLOB_S3_BUCKET_RAW=chartly-raw
BLOB_S3_BUCKET_ARTIFACTS=chartly-artifacts

############################
# Queue backend (implementation-dependent)
# Options: redis, nats, kafka (planned).
############################
QUEUE_BACKEND=redis

# Redis Streams settings (if QUEUE_BACKEND=redis)
QUEUE_REDIS_STREAM_PREFIX=chartly
QUEUE_REDIS_MAXLEN=100000

############################
# Service discovery (gateway -> internal services)
# For local dev, use localhost and the port vars above.
############################
AUTH_BASE_URL=http://localhost:8087
ORCHESTRATOR_BASE_URL=http://localhost:8081
CONNECTOR_HUB_BASE_URL=http://localhost:8082
NORMALIZER_BASE_URL=http://localhost:8083
ANALYTICS_BASE_URL=http://localhost:8084
STORAGE_BASE_URL=http://localhost:8085
AUDIT_BASE_URL=http://localhost:8086
OBSERVER_BASE_URL=http://localhost:8088

############################
# Auth / RBAC (local)
############################
AUTH_ENABLED=false
AUTH_JWT_ISSUER=chartly-local
AUTH_JWT_AUDIENCE=chartly
# DO NOT use real secrets here. Rotate in prod via secret manager.
AUTH_JWT_SIGNING_KEY=dev-only-change-me

############################
# Rate limiting / politeness (connector-hub)
############################
CONNECTOR_HUB_MAX_CONCURRENCY=500
CONNECTOR_HUB_PER_DOMAIN_CONCURRENCY=10
CONNECTOR_HUB_DEFAULT_RPM=120
CONNECTOR_HUB_TIMEOUT_SECONDS=30

############################
# Normalizer
############################
NORMALIZER_MAX_RECORDS_PER_JOB=20000
NORMALIZER_QUARANTINE_ENABLED=true

############################
# Audit
############################
AUDIT_ENABLED=true
AUDIT_HASH_ALGO=sha256

############################
# Observability (OpenTelemetry)
############################
OTEL_ENABLED=false
OTEL_SERVICE_NAME=chartly
OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4317
OTEL_EXPORTER_OTLP_PROTOCOL=grpc

############################
# Feature flags
############################
FEATURE_ANALYTICS_ENABLED=false
FEATURE_WEB_ENABLED=false
FEATURE_SDK_CODEGEN_ENABLED=false
