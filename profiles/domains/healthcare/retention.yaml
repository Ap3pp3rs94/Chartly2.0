version: "1.0"

inherits:
  base_retention_file: "profiles/core/base/retention.yaml"
  strategy:
    - "override: retention days to reduce PHI exposure"
    - "tighten: access constraints for raw plane"
    - "do_not_change: audit append-only semantics"

retention_engine:
  enforcement: "planned"
  notes:
    - "Healthcare domain handles PHI; minimize retention of raw payloads when feasible."
    - "Retention must still support investigation and reproducibility for audits."
    - "All deletions/compactions must be recorded as audit events."

planes:
  raw_plane:
    enabled: true
    default_retention_days: 30
    deletion_policy: "delete_after_retention"
    compaction_policy: "none"
    notes:
      - "Raw payloads may contain PHI; keep retention as short as operationally feasible."
      - "If regulatory or organizational policy requires longer retention, override with explicit approval."

  canonical_plane:
    enabled: true
    default_retention_days: 365
    deletion_policy: "delete_after_retention"
    compaction_policy:
      enabled: true
      strategy: "time_bucket_compaction"
      bucket_granularity: "day"
      downsampling_planned: true
    notes:
      - "Canonical plane should be PHI-minimized; retain for operational analytics."

  audit_plane:
    enabled: true
    default_retention_days: 3650
    immutability: true
    deletion_policy: "no_delete_by_default"
    verification_retention:
      keep_hash_chain_forever: true
      verification_snapshots_days: 3650
    notes:
      - "Audit is essential for HIPAA-aligned accountability; retain long-term."

legal_hold:
  required: true
  behavior: "skip_deletion_when_hold_present"
  notes:
    - "Legal hold overrides deletion for raw/canonical planes."
    - "Hold actions must be audited and access-controlled."

access_constraints:
  raw_plane:
    restricted: true
    allowed_roles: ["admin", "auditor"]
    notes:
      - "Operators may be granted access only if policy allows and is audited."
  canonical_plane:
    restricted: true
    allowed_roles: ["viewer", "operator", "admin", "auditor"]
    tenant_scoped: true

compliance_notes:
  framework: "HIPAA-aligned"
  guidance:
    - "Minimize PHI exposure by limiting raw retention and restricting access."
    - "Ensure audit logs capture access and processing events."
    - "Ensure data minimization in canonical outputs per phi_handling.yaml."

llm_assist:
  enabled: false
  notes:
    - "Retention is governance-sensitive; no LLM-driven changes."

# -----------------------------------------------------------------------------
# EXAMPLES (comments only)
#
# Example: Extend raw retention for a specific regulated workflow (requires approval)
# planes:
#   raw_plane:
#     default_retention_days: 90
# -----------------------------------------------------------------------------
