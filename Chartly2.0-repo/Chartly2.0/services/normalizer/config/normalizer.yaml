# Chartly 2.0  Normalizer configuration
#
# NOTE (IMPORTANT):
# - Current runtime behavior is driven by ENV vars in cmd/normalizer/main.go.
# - This file is a production-ready scaffold for future expansion.
# - Sections marked "ROADMAP" are NOT implemented yet and MUST be treated as placeholders.

service:
  name: normalizer
  env: local
  addr: ":8083"

  timeouts_ms:
    read: 5000
    write: 10000
    idle: 60000
    shutdown: 10000

  max_header_bytes: 1048576

headers:
  request_id: "X-Request-Id"
  tenant_id: "X-Tenant-Id"

cors:
  # IMPLEMENTED (local behavior): main.go enables permissive CORS when env=local.
  enabled: true
  allow_origins: ["*"]
  allow_methods: ["GET", "POST", "PUT", "PATCH", "DELETE", "OPTIONS"]
  allow_headers: ["Content-Type", "Authorization", "X-Request-Id", "X-Tenant-Id"]
  expose_headers: ["X-Request-Id"]

logging:
  # IMPLEMENTED: JSON lines to stdout via stdlib logger wrapper.
  format: json
  level: info

normalize_api:
  # IMPLEMENTED (STUB): /normalize exists but does not transform yet.
  enabled: true

  endpoints:
    normalize: true

  # ROADMAP: gateway-style rate limiting / tenant-level quotas
  rate_limit:
    enabled: false
    rps: 5
    burst: 10

transforms:
  # ROADMAP: declarative transform pipelines (rules + schema mappings)
  enabled: false
  pipelines: []
  # example:
  # pipelines:
  #   - id: "v1-default"
  #     match:
  #       connector_id: "*"
  #     steps:
  #       - kind: "map_fields"
  #         params: {}

output:
  # ROADMAP: output sinks for normalized artifacts (object store, db, event bus)
  enabled: false
  sink:
    type: "none" # none|filesystem|s3|postgres|kafka (future)
    config: {}

telemetry:
  # ROADMAP: metrics/tracing (OTEL, Prometheus, etc.)
  enabled: false
  metrics:
    enabled: false
  tracing:
    enabled: false
