# Chartly 2.0  Analytics Chart Templates Catalog
#
# IMPORTANT:
# - This file is DATA ONLY (a template catalog).
# - Loading/applying templates requires a template registry implementation (future file).
# - Do not treat anything here as "implemented behavior" by itself.
#
# The templates are designed to map cleanly into the JSON-serializable chart spec shape
# produced by internal/charts/chart_builder.go.

catalog:
  schema: "chartly.templates.v1"
  version: "1.0.0"
  updated_at: "REPLACE_AT_BUILD_TIME" # placeholder; registry may override when emitting metadata
  notes:
    - "Templates define deterministic defaults for chart specs."
    - "No external rendering library assumptions; consumers map these into their own UI."

templates:
  - id: "ts_line_v1"
    display_name: "Time Series  Line"
    chart_type: "line"
    tags: ["time_series", "line", "default"]
    defaults:
      theme: "light"
      max_points: 5000
      axes:
        x:
          label: "Time"
          type: "time"   # time|number|category|log
          unit: ""
        y:
          label: "Value"
          type: "number"
          unit: ""
          min: null
          max: null
      series_defaults:
        kind: "line"
        stack: ""
        unit: ""
        style:
          line_width: 2
          point_size: 0
          opacity: 1.0
          color: ""
      annotation_defaults:
        enabled: true
        series_overlay_name: "anomalies"
    constraints:
      expects_x: "RFC3339/RFC3339Nano timestamps or unix-like numeric x"
      expects_y: "numeric"
      recommended_point_order: "ascending time"
      supports_anomaly_overlay: true
    example_input:
      # Illustrative only (NOT a runtime contract)
      series:
        - name: "requests"
          points:
            - { x: "2026-01-30T00:00:00Z", y: 120 }
            - { x: "2026-01-30T00:01:00Z", y: 132 }

  - id: "ts_area_v1"
    display_name: "Time Series  Area"
    chart_type: "area"
    tags: ["time_series", "area"]
    defaults:
      theme: "light"
      max_points: 5000
      axes:
        x: { label: "Time", type: "time", unit: "" }
        y: { label: "Value", type: "number", unit: "" }
      series_defaults:
        kind: "area"
        stack: ""
        unit: ""
        style:
          line_width: 1.5
          point_size: 0
          opacity: 0.6
          color: ""
      annotation_defaults:
        enabled: true
        series_overlay_name: "anomalies"
    constraints:
      expects_x: "time"
      expects_y: "numeric"
      supports_anomaly_overlay: true
    example_input:
      series:
        - name: "sales"
          points:
            - { x: "2026-01-01T00:00:00Z", y: 1000 }
            - { x: "2026-01-02T00:00:00Z", y: 1400 }

  - id: "bar_grouped_v1"
    display_name: "Bar  Grouped"
    chart_type: "bar"
    tags: ["bar", "grouped", "category"]
    defaults:
      theme: "light"
      max_points: 500
      axes:
        x: { label: "Category", type: "category", unit: "" }
        y: { label: "Value", type: "number", unit: "" }
      series_defaults:
        kind: "bar"
        stack: "" # empty = grouped
        unit: ""
        style:
          opacity: 0.9
          color: ""
      annotation_defaults:
        enabled: false
        series_overlay_name: "anomalies"
    constraints:
      expects_x: "category labels (string)"
      expects_y: "numeric"
      grouping: "multiple series => grouped bars"
    example_input:
      series:
        - name: "north"
          points:
            - { x: "Jan", y: 10 }
            - { x: "Feb", y: 14 }
        - name: "south"
          points:
            - { x: "Jan", y: 8 }
            - { x: "Feb", y: 12 }

  - id: "bar_stacked_v1"
    display_name: "Bar  Stacked"
    chart_type: "bar"
    tags: ["bar", "stacked", "category"]
    defaults:
      theme: "light"
      max_points: 500
      axes:
        x: { label: "Category", type: "category", unit: "" }
        y: { label: "Total", type: "number", unit: "" }
      series_defaults:
        kind: "bar"
        stack: "default" # non-empty = stacked
        unit: ""
        style:
          opacity: 0.9
          color: ""
      annotation_defaults:
        enabled: false
        series_overlay_name: "anomalies"
    constraints:
      expects_x: "category labels (string)"
      expects_y: "numeric"
      stacking: "stack group id shared across series"
    example_input:
      series:
        - name: "paid"
          options: { stack: "default" }
          points:
            - { x: "Q1", y: 120 }
            - { x: "Q2", y: 140 }
        - name: "organic"
          options: { stack: "default" }
          points:
            - { x: "Q1", y: 80 }
            - { x: "Q2", y: 90 }

  - id: "scatter_v1"
    display_name: "Scatter  Correlation"
    chart_type: "scatter"
    tags: ["scatter", "correlation", "numeric"]
    defaults:
      theme: "light"
      max_points: 8000
      axes:
        x: { label: "X", type: "number", unit: "" }
        y: { label: "Y", type: "number", unit: "" }
      series_defaults:
        kind: "scatter"
        stack: ""
        unit: ""
        style:
          point_size: 3
          opacity: 0.7
          color: ""
      annotation_defaults:
        enabled: false
        series_overlay_name: "anomalies"
    constraints:
      expects_x: "numeric"
      expects_y: "numeric"
      notes: "Useful for pairwise metric comparison; trendline is FUTURE (feature unavailable)."
    example_input:
      series:
        - name: "events"
          points:
            - { x: 1.2, y: 3.4 }
            - { x: 2.1, y: 2.9 }

  - id: "histogram_v1"
    display_name: "Histogram  Distribution"
    chart_type: "histogram"
    tags: ["histogram", "distribution"]
    defaults:
      theme: "light"
      max_points: 20000
      axes:
        x: { label: "Bucket", type: "number", unit: "" }
        y: { label: "Count", type: "number", unit: "" }
      series_defaults:
        kind: "histogram"
        stack: ""
        unit: ""
        style:
          opacity: 0.85
          color: ""
      annotation_defaults:
        enabled: false
        series_overlay_name: "anomalies"
    constraints:
      expects_x: "numeric values (raw) OR pre-bucketed points, depending on consumer"
      notes: "Bucket strategy is FUTURE (feature unavailable in analytics service yet)."
    example_input:
      series:
        - name: "latency_ms"
          # Illustrative: either raw values or (bucket_start,count) points depending on consumer.
          points:
            - { x: 10, y: 5 }
            - { x: 20, y: 12 }

  - id: "table_v1"
    display_name: "Table  Summary"
    chart_type: "table"
    tags: ["table", "summary"]
    defaults:
      theme: "light"
      max_points: 1000
      axes:
        x: { label: "Field", type: "category", unit: "" }
        y: { label: "Value", type: "category", unit: "" }
      series_defaults:
        kind: "table"
        stack: ""
        unit: ""
        style:
          opacity: 1.0
      annotation_defaults:
        enabled: false
        series_overlay_name: "anomalies"
    constraints:
      expects_x: "field/key"
      expects_y: "numeric or string (serialized by consumer)"
    example_input:
      series:
        - name: "kpis"
          points:
            - { x: "MAU", y: 12345, label: "Monthly Active Users" }
            - { x: "Churn", y: 0.042, label: "Monthly Churn" }

  - id: "ts_line_anomaly_overlay_v1"
    display_name: "Time Series  Line + Anomaly Overlay"
    chart_type: "line"
    tags: ["time_series", "line", "anomaly_overlay"]
    defaults:
      theme: "light"
      max_points: 8000
      axes:
        x: { label: "Time", type: "time", unit: "" }
        y: { label: "Value", type: "number", unit: "" }
      series_defaults:
        kind: "line"
        stack: ""
        unit: ""
        style:
          line_width: 2
          point_size: 0
          opacity: 1.0
          color: ""
      annotation_defaults:
        enabled: true
        series_overlay_name: "anomalies"
        anomaly_style:
          kind: "scatter"
          point_size: 4
          opacity: 0.85
          color: ""
    constraints:
      expects_x: "time"
      expects_y: "numeric"
      anomaly_input: "optional anomaly markers with x/ts, y, score, reason"
    example_input:
      series:
        - name: "requests"
          points:
            - { x: "2026-01-30T00:00:00Z", y: 120 }
            - { x: "2026-01-30T00:01:00Z", y: 500 }
      anomalies:
        - { ts: "2026-01-30T00:01:00Z", y: 500, score: 4.2, direction: "high", reason: "spike" }

dashboard_packs:
  # Convenience groups for future UI/workflow selection (IDs only).
  - id: "ops_observability_pack_v1"
    display_name: "Ops Observability Pack"
    template_ids:
      - "ts_line_v1"
      - "ts_line_anomaly_overlay_v1"
      - "histogram_v1"
      - "table_v1"

  - id: "biz_kpi_pack_v1"
    display_name: "Business KPI Pack"
    template_ids:
      - "bar_grouped_v1"
      - "bar_stacked_v1"
      - "ts_area_v1"
      - "table_v1"
